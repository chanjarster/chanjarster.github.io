<!DOCTYPE html>

<html lang="zh-cn">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no"/>

    <title>颇忒脱的技术博客</title>
    
    <link rel="apple-touch-icon" sizes="180x180" href="https://chanjarster.github.io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://chanjarster.github.io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://chanjarster.github.io/favicon-16x16.png">
    <link rel="manifest" href="https://chanjarster.github.io/manifest.json">
    <link rel="mask-icon" href="https://chanjarster.github.io/safari-pinned-tab.svg" color="#FF3DB4">
    <meta name="theme-color" content="#ffffff">

    
    
    
    <link rel="stylesheet" href="https://chanjarster.github.io/css/main.min.03322cbe6bddfc28e7b17b84bc5446282a510b14b57be3371ba1f68ef1ab9ce8.css"/>

    
    
    

    
    
 
    
    
</head>
    <body>
        
<nav>
  <header>
    <div class="site-title">
        <a href="https://chanjarster.github.io/">颇忒脱的技术博客</a>
    </div>  
</header>
  <div class="nav-menu">
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/">Home</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/tags/%E6%94%B6%E8%97%8F%E5%A4%B9/">Bookmarks</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/post/concurrent-programming/index-page">并发编程</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/post/mysql/index-page">MySQL</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/tags/go/">Go</a>
  
    <a class="color-link nav-link" href="https://github.com/chanjarster">Works</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/tags/">Tags</a>
  
  <a class="color-link nav-link" href="https://chanjarster.github.io/index.xml" target="_blank" rel="noopener" type="application/rss+xml">RSS</a>
</div>
<footer class="footer">
	<div class="social-icons">
        

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="chanjarster" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    
    

    

    

    

    

</div>




	<p><a href="https://github.com/kimcc/hugo-theme-noteworthy" target="_blank" rel="noopener">Noteworthy theme</a></p>
	<p><a href="https://gohugo.io" target="_blank" rel="noopener">Built with Hugo</a></p>

	<script src="https://chanjarster.github.io/js/main.min.fa5c2b23e07b5d9bfad267a52b4b24fdb053e6fb7524993383594926a3ac270c.js" integrity="sha256-+lwrI+B7XZv60melK0sk/bBT5vt1JJkzg1lJJqOsJww="></script>
</footer>
</nav>
        <div id="content" class="content-container">
        
<h1 class="post-title">Cracking Coding Interview - 16.23 Rand7 from Rand5</h1>
    
    <time>September 18, 2019</time>
    
    <div>
        <p>
        <p><strong>Rand7 from Rand5</strong>: Implement a method <code>rand7()</code> given <code>rand5()</code>. That is, given a method that generates a random number between 0 and 4 (inclusive), write a method that generates a random number between 0 and 6 (inclusive).</p>
<p>Hints: #505, #574, #637, #668, #697, #720</p>
<h2 id="解法">解法</h2>
<p><code>rand5()</code>的范围是<code>[0, 4]</code>，先看看那么两个<code>rand5()</code>相加是否能够等价<code>rand10()</code>即<code>[0, 9]</code>。</p>
<table>
<thead>
<tr>
<th>结果</th>
<th>组合</th>
<th>概率</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0 + 0</td>
<td>0.04( 0.2 * 0.2)</td>
</tr>
<tr>
<td>1</td>
<td>1 + 0, 0 + 1</td>
<td>2 * 0.04 = 0.08</td>
</tr>
<tr>
<td>2</td>
<td>1 + 1, 0 + 2, 2 + 0</td>
<td>3 * 0.04 = 0.12</td>
</tr>
<tr>
<td>3</td>
<td>1 + 2, 2 + 1, 0 + 3, 3 + 0</td>
<td>4 * 0.04 = 0.16</td>
</tr>
<tr>
<td>4</td>
<td>1 + 3, 3 + 1, 0 + 4, 4 + 0, 2 + 2</td>
<td>5 * 0.04 = 0.20</td>
</tr>
<tr>
<td>5</td>
<td>1 + 4, 4 + 1, 2 + 3, 3 + 2</td>
<td>4 * 0.04 = 0.16</td>
</tr>
<tr>
<td>6</td>
<td>3 + 3, 2 + 4, 4 + 2</td>
<td>3 * 0.04 = 0.12</td>
</tr>
<tr>
<td>7</td>
<td>3 + 4, 4 + 3</td>
<td>2 * 0.04 = 0.08</td>
</tr>
<tr>
<td>8</td>
<td>4 + 4</td>
<td>0.2 * 0.2 = 0.04</td>
</tr>
</tbody>
</table>
<p>可以每个结果的概率并不相同，所以不能成立。其实同理，相乘也不能成立。</p>
<p>如果对结果取模，那么分布就变成了：</p>
<table>
<thead>
<tr>
<th>结果</th>
<th>组合</th>
<th>概率</th>
</tr>
</thead>
<tbody>
<tr>
<td>0,7 (7 % 7 = 0)</td>
<td>0 + 0, 3 + 4, 4 + 3</td>
<td>3 * 0.04 = 0.12</td>
</tr>
<tr>
<td>1,8 (8 % 7 = 1)</td>
<td>1 + 0, 0 + 1, 4 + 4</td>
<td>3 * 0.04 = 0.12</td>
</tr>
<tr>
<td>2</td>
<td>1 + 1, 0 + 2, 2 + 0</td>
<td>3 * 0.04 = 0.12</td>
</tr>
<tr>
<td>3</td>
<td>1 + 2, 2 + 1, 0 + 3, 3 + 0</td>
<td>4 * 0.04 = 0.16</td>
</tr>
<tr>
<td>4</td>
<td>1 + 3, 3 + 1, 0 + 4, 4 + 0, 2 + 2</td>
<td>5 * 0.04 = 0.20</td>
</tr>
<tr>
<td>5</td>
<td>1 + 4, 4 + 1, 2 + 3, 3 + 2</td>
<td>4 * 0.04 = 0.16</td>
</tr>
<tr>
<td>6</td>
<td>3 + 3, 2 + 4, 4 + 2</td>
<td>3 * 0.04 = 0.12</td>
</tr>
</tbody>
</table>
<p>回发现概率分布还是不均匀。</p>
<p>得想一个办法将各种结果出现的概率弄成一致，如果这样 <code>5 * rand5() + rand5()</code>：</p>
<table>
<thead>
<tr>
<th>因子1</th>
<th>因子2</th>
<th>结果</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>0</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td>0</td>
<td>10</td>
<td>10</td>
</tr>
<tr>
<td>0</td>
<td>15</td>
<td>15</td>
</tr>
<tr>
<td>0</td>
<td>20</td>
<td>20</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>5</td>
<td>6</td>
</tr>
<tr>
<td>1</td>
<td>10</td>
<td>11</td>
</tr>
<tr>
<td>1</td>
<td>15</td>
<td>16</td>
</tr>
<tr>
<td>1</td>
<td>20</td>
<td>21</td>
</tr>
<tr>
<td>2</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td>2</td>
<td>5</td>
<td>7</td>
</tr>
<tr>
<td>2</td>
<td>10</td>
<td>12</td>
</tr>
<tr>
<td>2</td>
<td>15</td>
<td>17</td>
</tr>
<tr>
<td>2</td>
<td>20</td>
<td>22</td>
</tr>
<tr>
<td>3</td>
<td>0</td>
<td>3</td>
</tr>
<tr>
<td>3</td>
<td>5</td>
<td>8</td>
</tr>
<tr>
<td>3</td>
<td>10</td>
<td>13</td>
</tr>
<tr>
<td>3</td>
<td>15</td>
<td>18</td>
</tr>
<tr>
<td>3</td>
<td>20</td>
<td>23</td>
</tr>
<tr>
<td>4</td>
<td>0</td>
<td>4</td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>9</td>
</tr>
<tr>
<td>4</td>
<td>10</td>
<td>14</td>
</tr>
<tr>
<td>4</td>
<td>15</td>
<td>19</td>
</tr>
<tr>
<td>4</td>
<td>20</td>
<td>24</td>
</tr>
</tbody>
</table>
<p>可以发现，结果出现的次数都是一次，也就是概率相同。那么，我们可以抛弃掉[21, 24]这4个结果，在[0, 20]之间 % 7，代码：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">rand7</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
  <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">int</span> num <span style="color:#f92672">=</span> rand5<span style="color:#f92672">()</span> <span style="color:#f92672">*</span> 5 <span style="color:#f92672">+</span> rand5<span style="color:#f92672">();</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>num <span style="color:#f92672">&lt;</span> 21<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      <span style="color:#66d9ef">return</span> num <span style="color:#f92672">%</span> 7<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>为什么这样做概率是均匀的？我们可以把代码做一个转换，因为已知<code>rand5(5) + rand(5)</code>能够得到一个均匀分布的[0, 24]的区间，那么就等价于<code>rand25()</code>，然后我们把 % 7 这个操作去掉，把代码变成这样：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">rand21</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
  <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">int</span> num <span style="color:#f92672">=</span> rand<span style="color:#f92672">(</span>25<span style="color:#f92672">);</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>num <span style="color:#f92672">&lt;</span> 21<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      <span style="color:#66d9ef">return</span> num<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>假设每次调用<code>rand25()</code>的返回结果是<code>0, 1, 2, 3, ..., 24, 0, 1, 2, ..., 24</code>，那么调用<code>rand21()</code>的记录就是：</p>
<table>
<thead>
<tr>
<th>rand21()结果</th>
<th>rand25()调用结果</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>&hellip;</td>
<td>&hellip;</td>
</tr>
<tr>
<td>20</td>
<td>20</td>
</tr>
<tr>
<td>0</td>
<td>21, 22, 23, 24, 0，结果取0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>&hellip;</td>
<td></td>
</tr>
</tbody>
</table>
<p>可以看到<code>rand21()</code>的结果的分布都是均匀的，所以解法提到的方法是可行的。</p>
        </p>
    </div>
    

    <div class="page-footer">
        
        <hr class="footer-divider">
        
            <a class="tag" href="https://chanjarster.github.io/tags/arts">#ARTS</a>
        
            <a class="tag" href="https://chanjarster.github.io/tags/arts-a">#ARTS-A</a>
        
      
    </div>


        
        </div>
        <footer class="footer-mobile">
	<div class="social-icons">
        

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="chanjarster" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    
    

    

    

    

    

</div>




	<div class="footer-mobile-links">
		<p><a href="https://github.com/kimcc/hugo-theme-noteworthy" target="_blank" rel="noopener">Noteworthy theme</a></p>
		<span class="divider-bar">|</span>
		<p><a href="https://gohugo.io" target="_blank" rel="noopener">Built with Hugo</a></p>
	</div>

	<script src="https://chanjarster.github.io/js/main.min.fa5c2b23e07b5d9bfad267a52b4b24fdb053e6fb7524993383594926a3ac270c.js" integrity="sha256-+lwrI+B7XZv60melK0sk/bBT5vt1JJkzg1lJJqOsJww="></script>
</footer>
    </body>
</html>