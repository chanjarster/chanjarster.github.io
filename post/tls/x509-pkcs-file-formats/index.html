<!DOCTYPE html>

<html lang="zh-cn">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no"/>

    <title>颇忒脱的技术博客</title>
    
    <link rel="apple-touch-icon" sizes="180x180" href="https://chanjarster.github.io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://chanjarster.github.io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://chanjarster.github.io/favicon-16x16.png">
    <link rel="manifest" href="https://chanjarster.github.io/manifest.json">
    <link rel="mask-icon" href="https://chanjarster.github.io/safari-pinned-tab.svg" color="#FF3DB4">
    <meta name="theme-color" content="#ffffff">

    
    
    
    <link rel="stylesheet" href="https://chanjarster.github.io/css/main.min.03322cbe6bddfc28e7b17b84bc5446282a510b14b57be3371ba1f68ef1ab9ce8.css"/>

    
    
    

    
    
 
    
    
</head>
    <body>
        
<nav>
  <header>
    <div class="site-title">
        <a href="https://chanjarster.github.io/">颇忒脱的技术博客</a>
    </div>  
</header>
  <div class="nav-menu">
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/">Home</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/tags/%E6%94%B6%E8%97%8F%E5%A4%B9/">Bookmarks</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/post/jvm/index-page">JVM</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/post/concurrent-programming/index-page">并发编程</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/post/mysql/index-page">MySQL</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/tags/go/">Go</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/tags/gc/">GC</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/tags/kernel/">Kernel</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/tags/cheatsheet/">Cheatsheet</a>
  
    <a class="color-link nav-link" href="https://github.com/chanjarster">Works</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/tags/">Tags</a>
  
  <a class="color-link nav-link" href="https://chanjarster.github.io/index.xml" target="_blank" rel="noopener" type="application/rss+xml">RSS</a>
</div>
<footer class="footer">
	<div class="social-icons">
        

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="chanjarster" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    
    

    

    

    

    

</div>




	<p><a href="https://github.com/kimcc/hugo-theme-noteworthy" target="_blank" rel="noopener">Noteworthy theme</a></p>
	<p><a href="https://gohugo.io" target="_blank" rel="noopener">Built with Hugo</a></p>

	<script src="https://chanjarster.github.io/js/main.min.fa5c2b23e07b5d9bfad267a52b4b24fdb053e6fb7524993383594926a3ac270c.js" integrity="sha256-+lwrI+B7XZv60melK0sk/bBT5vt1JJkzg1lJJqOsJww="></script>
</footer>
</nav>
        <div id="content" class="content-container">
        
<h1 class="post-title">X.509、PKCS文件格式介绍</h1>
    
    <time>April 27, 2019</time>
    
    <div>
        <p>
        <h2 id="asn1---数据结构描述语言">ASN.1 - 数据结构描述语言</h2>
<p>引用自<a href="https://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One">Wiki</a>：</p>
<blockquote>
<p>ASN.1 is a standard <strong>interface description language</strong> for defining <strong>data structures</strong> that can be serialized and deserialized in a <strong>cross-platform</strong> way.</p>
</blockquote>
<p>也就是说ASN.1是一种用来定义数据结构的接口描述语言，它不是二进制，也不是文件格式，看下面的例子你就会明白了：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">FooQuestion ::= SEQUENCE {
    trackingNumber INTEGER,
    question       IA5String
}
</code></pre></div><p>这段代码定义了FooQuestion的数据结构，下面是FooQuestion这个数据接口的某个具体的数据：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">myQuestion FooQuestion ::= SEQUENCE {
    trackingNumber     5,
    question           &#34;Anybody there?&#34;
}
</code></pre></div><p>ASN.1用在很多地方比如下面要讲的<a href="https://en.wikipedia.org/wiki/X.509">X.509</a>和<a href="https://en.wikipedia.org/wiki/PKCS">PKCS group of cryptography standards</a>。</p>
<h2 id="文件编码格式">文件编码格式</h2>
<h3 id="der编码格式">DER编码格式</h3>
<p>引用自<a href="https://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One">Wiki</a>：</p>
<blockquote>
<p>ASN.1 is closely associated with a set of encoding rules that specify how to represent a data structure as a series of bytes</p>
</blockquote>
<p>意思是ASN.1有一套关联的编码规则，这些编码规则用来规定如何用二进制来表示数据结构，<a href="https://en.wikipedia.org/wiki/X.690#DER_encoding">DER</a>是其中一种。</p>
<p>把上面的FooQuestion的例子用DER编码则是（16进制）：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">30 13 02 01 05 16 0e 41 6e 79 62 6f 64 79 20 74 68 65 72 65 3f
</code></pre></div><p>翻译过来就是：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">30 — type tag indicating SEQUENCE
13 — length in octets of value that follows
  02 — type tag indicating INTEGER
  01 — length in octets of value that follows
    05 — value (5)
  16 — type tag indicating IA5String 
     (IA5 means the full 7-bit ISO 646 set, including variants, 
      but is generally US-ASCII)
  0e — length in octets of value that follows
    41 6e 79 62 6f 64 79 20 74 68 65 72 65 3f — value (&#34;Anybody there?&#34;)
</code></pre></div><p>看到这里你应该对DER编码格式有一个比较好的认识了。</p>
<h3 id="pem编码格式">PEM编码格式</h3>
<p>引用自<a href="https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail">Wiki</a>：</p>
<blockquote>
<p>Privacy-Enhanced Mail (PEM) is a de facto file format for storing and sending cryptographic keys, certificates, and other data, based on a set of 1993 IETF standards defining &ldquo;privacy-enhanced mail.&rdquo;</p>
</blockquote>
<p>PEM是一个用来存储和发送密码学key、证书和其他数据的文件格式的事实标准。许多使用ASN.1的密码学标准（比如<a href="https://en.wikipedia.org/wiki/X.509">X.509</a>和<a href="https://en.wikipedia.org/wiki/PKCS">PKCS</a>）都使用DER编码，而DER编码的内容是二进制的，不适合与邮件传输（早期Email不能发送附件），因此使用PEM把二进制内容转换成ASCII码。文件内容的格式像下面这样：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">-----BEGIN label-----
BASE64Encoded
-----END label-----
</code></pre></div><p>label用来区分内容到底是什么类型，下面会讲。</p>
<p>和PEM相关的RFC有很多，与本文内容相关的则是<a href="https://tools.ietf.org/html/rfc7468">RFC7468</a>，这里面规定了很多label，不过要注意不是所有label都会有对应的RFC或Specification，这些label只是一种约定俗成。</p>
<p>PEM实际上就是把DER编码的文件的二进制内容用base64编码一下，然后加上<code>-----BEGIN label-----</code>这样的头和<code>-----END label-----</code>这样的尾，中间则是DER文件的Base64编码。</p>
<p>我们可以通过下面的方法验证这个结论，先生成一个RSA Private Key，编码格式是PEM格式：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">openssl genrsa -out key.pem
</code></pre></div><p>查看一下文件内容，可以看到label是<code>RSA PRIVATE KEY</code>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">-----BEGIN RSA PRIVATE KEY-----
BASE64Encoded
-----END RSA PRIVATE KEY-----
</code></pre></div><p>然后我们把PEM格式转换成DER格式：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">openssl rsa -in key.pem -outform der -out key.der
</code></pre></div><p>如果你这个时候看一下文件内容会发现都是二进制。然后我们把DER文件的内容Base64一下，会看到内容和PEM文件一样（忽略头尾和换行）：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">base64 -i key.der -o key.der.base64
</code></pre></div><h2 id="证书密码学key格式">证书、密码学Key格式</h2>
<p>上面讲到的PEM是对证书、密码学Key文件的一种编码方式，下面举例这些证书、密码学Key文件格式：</p>
<h3 id="x509证书">X.509证书</h3>
<p>引用自<a href="https://en.wikipedia.org/wiki/X.509">Wiki</a> ：</p>
<blockquote>
<p>In cryptography, <strong>X.509</strong> is a standard defining the format of public key certificates. X.509 certificates are used in many Internet protocols, including TLS/SSL, which is the basis for HTTPS, the secure protocol for browsing the web.</p>
</blockquote>
<p>X.509是一个<a href="https://en.wikipedia.org/wiki/Public_key_certificate">Public Key Certificates</a>的格式标准，TLS/SSL使用它，TLS/SSL是HTTPS的基础所以HTTPS也使用它。而所谓<a href="https://en.wikipedia.org/wiki/Public_key_certificate">Public Key Certificates</a>又被称为<strong>Digital Certificate</strong> 或 <strong>Identity Certificate</strong>。</p>
<blockquote>
<p>An X.509 certificate contains a public key and an identity (a hostname, or an organization, or an individual), and is either signed by a certificate authority or self-signed.</p>
</blockquote>
<p>一个X.509 Certificate包含一个Public Key和一个身份信息，它要么是被CA签发的要么是自签发的。</p>
<p>下面这种张图就是一个X.509 Certificate：</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/0/01/Client_and_Server_Certificate.png" alt=""></p>
<p>事实上X.509 Certificate这个名词通常指代的是IETF的PKIX Certificate和CRL Profile，见<a href="https://tools.ietf.org/html/rfc5280">RFC5280</a>。所以当你看到PKIX Certificate字样的时候可以认为就是X.509 Certificate。</p>
<h3 id="pkcs系列">PKCS系列</h3>
<p>引用自<a href="https://en.wikipedia.org/wiki/PKCS">Wiki</a>：</p>
<blockquote>
<p>In cryptography, <strong>PKCS</strong> stands for &ldquo;Public Key Cryptography Standards&rdquo;</p>
</blockquote>
<p>前面提到的X.509是定义Public Key Certificates的格式的标准，看上去和PKCS有点像，但实际上不同，PKCS是Public Key密码学标准。此外<a href="https://en.wikipedia.org/wiki/Public-key_cryptography">Public-Key Cryptography</a>虽然名字看上去只涉及Public Key，实际上也涉及Priviate Key，因此PKCS也涉及Private Key。</p>
<p>PKCS一共有15个标准编号从1到15，这里只挑讲PKCS #1、PKCS #8、PKCS #12。</p>
<h3 id="pkcs-1">PKCS #1</h3>
<p>PKCS #1，RSA Cryptography Standard，定义了RSA Public Key和Private Key数学属性和格式，详见<a href="https://tools.ietf.org/html/rfc8017">RFC8017</a>。</p>
<h3 id="pkcs-8">PKCS #8</h3>
<p>PKCS #8，Private-Key Information Syntax Standard，用于加密或非加密地存储Private Certificate Keypairs（不限于RSA），详见<a href="https://tools.ietf.org/html/rfc5958">RFC5858</a>。</p>
<h3 id="pkcs-12">PKCS #12</h3>
<p>PKCS #12定义了通常用来存储Private Keys和Public Key Certificates（例如前面提到的X.509）的文件格式，使用基于密码的对称密钥进行保护。注意上述Private Keys和Public Key Certificates是复数形式，这意味着PKCS #12文件实际上是一个Keystore，PKCS #12文件可以被用做<a href="https://en.wikipedia.org/wiki/Keystore">Java Key Store</a>（JKS），详见<a href="https://tools.ietf.org/html/rfc7292">RFC7292</a>。</p>
<p>如果你用自己的CA所签发了一个证书，运行下列命令可以生成PKCS #12 keystore：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">openssl pkcs12 -export <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  -in &lt;cert&gt; <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  -inkey &lt;private-key&gt; <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  -name my-cert <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  -caname my-ca-root <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  -CAfile &lt;ca-cert&gt; <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  -chain
  -out &lt;pkcs-file&gt;
</code></pre></div><p>PKCS #12一般不导出PEM编码格式。</p>
<h2 id="pem格式速查">PEM格式速查</h2>
<p>当你不知道你的PEM文件内容是什么格式的可以根据下面查询。</p>
<h3 id="x509-certificate">X.509 Certificate</h3>
<p><a href="https://tools.ietf.org/html/rfc7468#section-5.1">RFC7468 - Textual Encoding of Certificates</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">-----BEGIN CERTIFICATE-----
BASE64Encoded
-----END CERTIFICATE-----
</code></pre></div><h3 id="x509-certificate-subject-public-key-info">X.509 Certificate Subject Public Key Info</h3>
<p><a href="https://tools.ietf.org/html/rfc7468#section-13">RFC7468 - Textual Encoding of Subject Public Key Info</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">-----BEGIN PUBLIC KEY-----
BASE64Encoded
-----END PUBLIC KEY-----
</code></pre></div><h3 id="pkcs-1-private-key">PKCS #1 Private Key</h3>
<p>没有RFC或权威Specification，该格式有时候被称为traditional format、SSLeay format（见<a href="https://crypto.stackexchange.com/a/47433">SO</a>）</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">-----BEGIN RSA PRIVATE KEY-----
BASE64Encoded
-----END RSA PRIVATE KEY-----
</code></pre></div><h3 id="pkcs-1-public-key">PKCS #1 Public Key</h3>
<p>同上没有RFC或权威Specification</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">-----BEGIN RSA PUBLIC KEY-----
BASE64Encoded
-----END RSA PUBLIC KEY-----
</code></pre></div><h3 id="pkcs-8-unencrypted-private-key">PKCS #8 Unencrypted Private Key</h3>
<p><a href="https://tools.ietf.org/html/rfc7468#section-10">RFC7468 - One Asymmetric Key and the Textual Encoding of PKCS #8 Private Key Info</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">-----BEGIN PRIVATE KEY-----
BASE64Encoded
-----END PRIVATE KEY-----
</code></pre></div><h3 id="pkcs-8-encrypted-private-key">PKCS #8 Encrypted Private Key</h3>
<p><a href="https://tools.ietf.org/html/rfc7468#section-11">RFC7468 - Textual Encoding of PKCS #8 Encrypted Private Key Info</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">-----BEGIN ENCRYPTED PRIVATE KEY-----
BASE64Encoded
-----END ENCRYPTED PRIVATE KEY-----
</code></pre></div><h2 id="private-key操作命令">Private Key操作命令</h2>
<h3 id="生成">生成</h3>
<p><strong>生成PKCS #1格式的RSA Private Key</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">openssl genrsa -out private-key.p1.pem <span style="color:#ae81ff">2048</span>
</code></pre></div><h3 id="转换">转换</h3>
<p><strong>PKCS #1 -&gt; Unencrypted PKCS #8</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">openssl pkcs8 -topk8 -in private-key.p1.pem -out private-key.p8.pem -nocrypt
</code></pre></div><p><strong>PKCS #1 -&gt; Encrypted PKCS #8</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">openssl pkcs8 -topk8 -in private-key.p1.pem -out private-key.p8.pem
</code></pre></div><p>过程中会让你输入密码，你至少得输入4位，所以PKCS #8相比PKCS #1更安全。</p>
<p><strong>PKCS #8 -&gt; PKCS #1</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">openssl rsa -in private-key.p8.pem -out private-key.p1.pem
</code></pre></div><p>如果这个PKCS #8是加密的，那么你得输入密码。</p>
<p><strong>PKCS #8 Unencrypted -&gt; PKCS #8 Encrypted</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">openssl pkcs8 -topk8 -in private-key.p8.nocrypt.pem -out private-key.p8.crypt.pem
</code></pre></div><p>过程中会让你输入密码，你至少得输入4位。</p>
<p><strong>PKCS #8 Encrypted -&gt; PKCS #8 Unencrypted</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">openssl pkcs8 -topk8 -in private-key.p8.crypt.pem -out private-key.p8.nocrypt.pem -nocrypt
</code></pre></div><p>过程中会要求你输入Private Key密码。</p>
<h2 id="public-key操作命令">Public Key操作命令</h2>
<h3 id="从pkcs-18提取">从PKCS #1/#8提取</h3>
<p>提取指的是从Private Key中提取Public Key，<code>openssl rsa</code>同时支持PKCS #1和PKCS #8的RSA Private Key，唯一的区别是如果PKCS #8是加密的，会要求你输入密码。</p>
<p><strong>提取X.509格式RSA Public Key</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">openssl rsa -in private-key.pem -pubout -out public-key.x509.pem
</code></pre></div><p><strong>提取PKCS #1格式RSA Public Key</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">openssl rsa -in private-key.pem -out public-key.p1.pem -RSAPublicKey_out
</code></pre></div><h3 id="从x509证书提取">从X.509证书提取</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">openssl x509 -in cert.pem -pubkey -noout &gt; public-key.x509.pem
</code></pre></div><h3 id="转换-1">转换</h3>
<p><strong>X.509 RSA Public Key -&gt; PKCS #1 RSA Public Key</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">openssl rsa -pubin -in public-key.x509.pem -RSAPublicKey_out -out public-key.p1.pem
</code></pre></div><p><strong>PKCS #1 RSA Public Key -&gt; X.509 RSA Public Key</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">openssl rsa -RSAPublicKey_in -in public-key.p1.pem -pubout -out public-key.x509.pem
</code></pre></div><h2 id="参考资料">参考资料</h2>
<ul>
<li><a href="https://www.feistyduck.com/library/openssl-cookbook/">OpenSSL Cookbook</a>，一本免费介绍OpenSSL的电子书</li>
<li><a href="https://blog.ndpar.com/2017/04/17/p1-p8/">PKCS #1, PKCS #8, X.509</a>，提供了很多格式转换的例子</li>
</ul>
        </p>
    </div>
    

    <div class="page-footer">
        
        <hr class="footer-divider">
        
            <a class="tag" href="https://chanjarster.github.io/tags/java">#java</a>
        
            <a class="tag" href="https://chanjarster.github.io/tags/tls">#tls</a>
        
            <a class="tag" href="https://chanjarster.github.io/tags/openssl">#openssl</a>
        
      
    </div>


        
        </div>
        <footer class="footer-mobile">
	<div class="social-icons">
        

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="chanjarster" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    
    

    

    

    

    

</div>




	<div class="footer-mobile-links">
		<p><a href="https://github.com/kimcc/hugo-theme-noteworthy" target="_blank" rel="noopener">Noteworthy theme</a></p>
		<span class="divider-bar">|</span>
		<p><a href="https://gohugo.io" target="_blank" rel="noopener">Built with Hugo</a></p>
	</div>

	<script src="https://chanjarster.github.io/js/main.min.fa5c2b23e07b5d9bfad267a52b4b24fdb053e6fb7524993383594926a3ac270c.js" integrity="sha256-+lwrI+B7XZv60melK0sk/bBT5vt1JJkzg1lJJqOsJww="></script>
</footer>
    </body>
</html>