<!DOCTYPE html>

<html lang="zh-cn">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no"/>

    <title>颇忒脱的技术博客</title>
    
    <link rel="apple-touch-icon" sizes="180x180" href="https://chanjarster.github.io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://chanjarster.github.io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://chanjarster.github.io/favicon-16x16.png">
    <link rel="manifest" href="https://chanjarster.github.io/manifest.json">
    <link rel="mask-icon" href="https://chanjarster.github.io/safari-pinned-tab.svg" color="#FF3DB4">
    <meta name="theme-color" content="#ffffff">

    
    
    
    <link rel="stylesheet" href="https://chanjarster.github.io/css/main.min.03322cbe6bddfc28e7b17b84bc5446282a510b14b57be3371ba1f68ef1ab9ce8.css"/>

    
    
    

    
    
 
    
    
</head>
    <body>
        
<nav>
  <header>
    <div class="site-title">
        <a href="https://chanjarster.github.io/">颇忒脱的技术博客</a>
    </div>  
</header>
  <div class="nav-menu">
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/">Home</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/tags/%E6%94%B6%E8%97%8F%E5%A4%B9/">Bookmarks</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/post/jvm/index-page">JVM</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/post/concurrent-programming/index-page">并发编程</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/post/mysql/index-page">MySQL</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/tags/go/">Go</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/tags/gc/">GC</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/tags/kernel/">Kernel</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/tags/cheatsheet/">Cheatsheet</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/tags/troubleshooting/">排障实战记录</a>
  
    <a class="color-link nav-link" href="https://github.com/chanjarster">Works</a>
  
    <a class="color-link nav-link" href="https://chanjarster.github.io/tags/">Tags</a>
  
  <a class="color-link nav-link" href="https://chanjarster.github.io/index.xml" target="_blank" rel="noopener" type="application/rss+xml">RSS</a>
</div>
<footer class="footer">
	<div class="social-icons">
        

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="chanjarster" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    
    

    

    

    

    

</div>




	<p><a href="https://github.com/kimcc/hugo-theme-noteworthy" target="_blank" rel="noopener">Noteworthy theme</a></p>
	<p><a href="https://gohugo.io" target="_blank" rel="noopener">Built with Hugo</a></p>

	<script src="https://chanjarster.github.io/js/main.min.fa5c2b23e07b5d9bfad267a52b4b24fdb053e6fb7524993383594926a3ac270c.js" integrity="sha256-+lwrI+B7XZv60melK0sk/bBT5vt1JJkzg1lJJqOsJww="></script>
</footer>
</nav>
        <div id="content" class="content-container">
        
<h1 class="post-title">Go Debug Cheatsheet</h1>
    
    <time>April 12, 2020</time>
    
    <div>
        <p>
        <h2 id="运行时环境变量">运行时环境变量</h2>
<h3 id="godebug">GODEBUG</h3>
<p><code>GODEBUG</code>是一个控制其他debugging变量的变量。它的值是逗号分割的<code>name=val</code>，比如<code>GCDEBUG=name1=val1,name2=val2</code>。</p>
<p><a href="https://golang.org/pkg/runtime/#hdr-Environment_Variables">runtime包的GODEBUG</a>，包含的内容比较广，这里只列举部分：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">GODEBUG<span style="color:#f92672">=</span>gctrace<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>         <span style="color:#75715e"># print gc logs</span>
GODEBUG<span style="color:#f92672">=</span>gcpacertrace<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>    <span style="color:#75715e">#causes the garbage collector to</span>
print information about the internal state of the concurrent pacer.
GODEBUG<span style="color:#f92672">=</span>memprofilerate<span style="color:#f92672">=</span>X  <span style="color:#75715e"># update the value of runtime.MemProfileRate</span>
</code></pre></div><p><a href="https://golang.org/pkg/net/">net包的GODEBUG</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">GODEBUG=netdns=go    # DNS相关，force pure Go resolver
GODEBUG=netdns=cgo   # DNS相关，force cgo resolver
GODEBUG=netdns=1     # DNS相关，print its decisions，这个比较有用会告诉你合适发生了DNS解析，以及DNS解析的尝试顺序
</code></pre></div><p><a href="https://golang.org/pkg/net/http/">net/http包的GODEBUG</a>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">GODEBUG=http2client=0  # disable HTTP/2 client support
GODEBUG=http2server=0  # disable HTTP/2 server support
GODEBUG=http2debug=1   # enable verbose HTTP/2 debug logs
GODEBUG=http2debug=2   # ... even more verbose, with frame dumps
</code></pre></div><h3 id="godebuggctrace1"><code>GODEBUG=gctrace=1</code></h3>
<p>如何解读gctrace见<a href="https://www.ardanlabs.com/blog/2019/05/garbage-collection-in-go-part2-gctraces.html">Garbage Collection In Go : Part II - GC Traces</a>。</p>
<h3 id="godebuggcpacertrace1"><code>GODEBUG=gcpacertrace=1</code></h3>
<p>TODO</p>
<h3 id="gogc">GOGC</h3>
<p><code>GOGC</code>是初始的垃圾回收目标百分比，默认100。GOGC的意思是“新分配的数据尺寸“对”上次GC剩下的live data的数据尺寸“之比，如果这个比，比如说，达到了100%，也就是1:1，那么久触发GC。</p>
<p>举个具体点的例子，上次GC上下了4M，那么现在新分配的数据也已经达到了4M，也就是说现在的内存总共占用了8M，这个时候触发GC。</p>
<p>如果<code>GOGC=off</code>，那么就彻底关掉了GC。</p>
<p>关于<code>GOGC</code>的更详细说明见<a href="https://golang.org/pkg/runtime/#hdr-Environment_Variables">runtime包</a>。也可见<a href="https://www.ardanlabs.com/blog/2019/05/garbage-collection-in-go-part2-gctraces.html">Garbage Collection In Go : Part II - GC Traces</a>。</p>
<h2 id="pprof相关">pprof相关</h2>
<p>pprof是go提供的profile工具，你可以很方便的得到CPU、内存、阻塞等方面的profile数据并分析。有以下几个<a href="https://golang.org/pkg/runtime/pprof/#Profile">profile类型</a>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">goroutine    - stack traces of all current goroutines
heap         - a sampling of memory allocations of live objects
allocs       - a sampling of all past memory allocations
threadcreate - stack traces that led to the creation of new OS threads
block        - stack traces that led to blocking on synchronization primitives
mutex        - stack traces of holders of contended mutexes
</code></pre></div><p>BlockProfile和MutexProfile需要设置采集频率才能采集到数据，因为它们默认不采集，相关文档如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ go doc runtime.SetBlockProfileRate
package runtime // import <span style="color:#e6db74">&#34;runtime&#34;</span>

func SetBlockProfileRate<span style="color:#f92672">(</span>rate int<span style="color:#f92672">)</span>
    SetBlockProfileRate controls the fraction of goroutine blocking events that
    are reported in the blocking profile. The profiler aims to sample an average
    of one blocking event per rate nanoseconds spent blocked.

    To include every blocking event in the profile, pass rate <span style="color:#f92672">=</span> 1. To turn off
    profiling entirely, pass rate &lt;<span style="color:#f92672">=</span> 0.

$ go doc runtime.SetMutexProfileFraction
package runtime // import <span style="color:#e6db74">&#34;runtime&#34;</span>

func SetMutexProfileFraction<span style="color:#f92672">(</span>rate int<span style="color:#f92672">)</span> int
    SetMutexProfileFraction controls the fraction of mutex contention events
    that are reported in the mutex profile. On average 1/rate events are
    reported. The previous rate is returned.

    To turn off profiling entirely, pass rate 0. To just read the current rate,
    pass rate &lt; 0. <span style="color:#f92672">(</span>For n&gt;1 the details of sampling may change.<span style="color:#f92672">)</span>  
</code></pre></div><p>MemoryProfile频率也是可以设置的（默认是开启的，因此可以不动），同时<code>GODEBUG=memprofilerate=X</code>也可以控制这个参数：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ go doc runtime.MemProfileRate
package runtime // import <span style="color:#e6db74">&#34;runtime&#34;</span>

var MemProfileRate int <span style="color:#f92672">=</span> <span style="color:#ae81ff">512</span> * <span style="color:#ae81ff">1024</span>
    MemProfileRate controls the fraction of memory allocations that are recorded
    and reported in the memory profile. The profiler aims to sample an average
    of one allocation per MemProfileRate bytes allocated.

    To include every allocated block in the profile, set MemProfileRate to 1. To
    turn off profiling entirely, set MemProfileRate to 0.

    The tools that process the memory profiles assume that the profile rate is
    constant across the lifetime of the program and equal to the current value.
    Programs that change the memory profiling rate should <span style="color:#66d9ef">do</span> so just once, as
    early as possible in the execution of the program <span style="color:#f92672">(</span><span style="color:#66d9ef">for</span> example, at the
    beginning of main<span style="color:#f92672">)</span>.
</code></pre></div><p>如何读懂pprof报告参考<a href="../pprof-explained/">解读pprof报告</a>。</p>
<h3 id="go-tool-pprof">go tool pprof</h3>
<p>go tool pprof用来分析profile文件的</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># 读取profile，cli交互式</span>
<span style="color:#75715e"># source可以是文件，比如cpu-profile.out，也可以是一个url，看下面“程序中内嵌profile server”</span>
<span style="color:#75715e"># url例子：http://localhost:6060/debug/pprof/heap 见下面http程序中内嵌profile</span>
<span style="color:#75715e"># 如果url启用了http basic auth，那么 http://user:pass@localhost:6060/debug/pprof/heap</span>
go tool pprof &lt;source&gt;
<span style="color:#75715e"># 读取profile，并在http://localhost:1234 提供web ui供你查看</span>
go tool pprof -http<span style="color:#f92672">=</span>:1234 &lt;profile file&gt;
<span style="color:#75715e"># 分析的同时提供程序的二进制文件，用于在分析时反编译（disasemble）</span>
go tool pprof &lt;binary&gt; &lt;source&gt;
<span style="color:#75715e"># 实时采集基于时间的profile，一般是url</span>
go tool pprof -seconds &lt;source&gt;
</code></pre></div><p><strong>在pprof中看到源码</strong></p>
<p>执行go tool pprof时所在目录为源码目录，那么可以在pprof里看到源码，比如：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">go tool pprof &lt;source&gt;
<span style="color:#f92672">(</span>pprof<span style="color:#f92672">)</span> list &lt;search string&gt;
ROUTINE <span style="color:#f92672">========================</span> institute.supwisdom.com/poa/gateway/util.init.0.func1 in util/jsonencoderpool.go
         <span style="color:#ae81ff">0</span>   512.03kB <span style="color:#f92672">(</span>flat, cum<span style="color:#f92672">)</span> 0.091% of Total
         .          .     26:	<span style="color:#66d9ef">return</span> UnsafeB2s<span style="color:#f92672">(</span>e.bf.B<span style="color:#f92672">)</span>
         .          .     27:<span style="color:#f92672">}</span>
         .          .     28:
         .          .     29:func init<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
         .          .     30:	jsonEncoderPool.New <span style="color:#f92672">=</span> func<span style="color:#f92672">()</span> interface<span style="color:#f92672">{}</span> <span style="color:#f92672">{</span>
         .   512.03kB     31:		bf :<span style="color:#f92672">=</span> bytebufferpool.Get<span style="color:#f92672">()</span>
         .          .     32:		<span style="color:#66d9ef">return</span> &amp;JsonEncoder<span style="color:#f92672">{</span>
         .          .     33:			bf:  bf,
         .          .     34:			enc: json.NewEncoder<span style="color:#f92672">(</span>bf<span style="color:#f92672">)</span>,
         .          .     35:		<span style="color:#f92672">}</span>
         .          .     36:	<span style="color:#f92672">}</span>
</code></pre></div><p>但有时候会找不到源码：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Error: open /gateway/apihandler/logging.go: no such file or directory
</code></pre></div><p>这个是因为编译时使用的源码目录和执行go tool pprof的目录不一样，一般来说都是前缀不同，你可以使用<code>-trim_path</code>将编译源码目录前缀删掉，比如这样：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">go tool pprof -trim_path<span style="color:#f92672">=</span>/gateway &lt;source&gt;
</code></pre></div><p>这样pprof就会去搜索<code>/apihandler/logging.go</code>，而如果你的当前目录正好有<code>apihandler/logging.go</code>，那么就能够得到源码了。</p>
<p><strong>二进制文件的搜索路径</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">PPROF_BINARY_PATH  Search path for local binary files
                      default: $HOME/pprof/binaries
                      searches $name, $path, $buildid/$name, $path/$buildid
</code></pre></div><p><strong>更多用法</strong></p>
<p>更多用法参见<code>go tool pprof -help</code></p>
<h3 id="go-test时产生profile">go test时产生profile</h3>
<p>你可以在go test的时候启用profile，输出的文件可以给pprof食用，<a href="https://golang.org/cmd/go/#hdr-Testing_flags">相关flag</a>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">-benchmem
    Print memory allocation statistics <span style="color:#66d9ef">for</span> benchmarks.

-blockprofile block.out
    Write a goroutine blocking profile to the specified file
    when all tests are complete.
    Writes test binary as -c would.

-blockprofilerate n
    Control the detail provided in goroutine blocking profiles by
    calling runtime.SetBlockProfileRate with n.
    See <span style="color:#e6db74">&#39;go doc runtime.SetBlockProfileRate&#39;</span>.
    The profiler aims to sample, on average, one blocking event every
    n nanoseconds the program spends blocked. By default,
    <span style="color:#66d9ef">if</span> -test.blockprofile is set without this flag, all blocking events
    are recorded, equivalent to -test.blockprofilerate<span style="color:#f92672">=</span>1.

-cpuprofile cpu.out
    Write a CPU profile to the specified file before exiting.
    Writes test binary as -c would.

-memprofile mem.out
    Write an allocation profile to the file after all tests have passed.
    Writes test binary as -c would.

-memprofilerate n
    Enable more precise <span style="color:#f92672">(</span>and expensive<span style="color:#f92672">)</span> memory allocation profiles by
    setting runtime.MemProfileRate. See <span style="color:#e6db74">&#39;go doc runtime.MemProfileRate&#39;</span>.
    To profile all memory allocations, use -test.memprofilerate<span style="color:#f92672">=</span>1.

-mutexprofile mutex.out
    Write a mutex contention profile to the specified file
    when all tests are complete.
    Writes test binary as -c would.

-mutexprofilefraction n
    Sample <span style="color:#ae81ff">1</span> in n stack traces of goroutines holding a
    contended mutex.
</code></pre></div><h3 id="http程序中内嵌profile">http程序中内嵌profile</h3>
<p>在你的包中引入<a href="https://golang.org/pkg/net/http/pprof/">net/http/pprof</a>，就可以给go tool pprof提供profile数据网页端：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">import</span> <span style="color:#a6e22e">_</span> <span style="color:#e6db74">&#34;net/http/pprof&#34;</span>
<span style="color:#66d9ef">go</span> <span style="color:#66d9ef">func</span>() {
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ListenAndServe</span>(<span style="color:#e6db74">&#34;localhost:6060&#34;</span>, <span style="color:#66d9ef">nil</span>))
}()
</code></pre></div><p>用它来配合<code>go tool pprof</code>可以很方便的采集profile数据。</p>
<p>总页面：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">http://localhost:6060/debug/pprof/ 
</code></pre></div><p>heap：</p>
<pre><code>http://localhost:6060/debug/pprof/heap
</code></pre><p>cpu:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">http://localhost:6060/debug/pprof/profile
</code></pre></div><p>block:</p>
<pre><code>http://localhost:6060/debug/pprof/block
</code></pre><p>mutex:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">http://localhost:6060/debug/pprof/mutex
</code></pre></div><h3 id="程序中内嵌profile功能">程序中内嵌profile功能</h3>
<p>你也可以在程序中内嵌生成profile的功能，详见<a href="https://golang.org/pkg/runtime/pprof/">runtime/pprof</a></p>
<h2 id="trace相关">Trace相关</h2>
<h3 id="go-tool-trace">go tool trace</h3>
<p><a href="https://golang.org/cmd/trace/">cmd/trace</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># 在浏览器中打开trace.out，如何得到trace.out下面会讲</span>
go tool trace -http<span style="color:#f92672">=</span>:4231 trace.out
<span style="color:#75715e"># 把trace文件转换成pprof文件，&lt;TYPE&gt;可以是</span>
<span style="color:#75715e">#  - net: network blocking profile</span>
<span style="color:#75715e">#  - sync: synchronization blocking profile</span>
<span style="color:#75715e">#  - syscall: syscall blocking profile</span>
<span style="color:#75715e">#  - sched: scheduler latency profile</span>
go tool trace -pprof<span style="color:#f92672">=</span>&lt;TYPE&gt; trace.out
</code></pre></div><h3 id="http程序中内嵌trace">http程序中内嵌trace</h3>
<p><a href="https://golang.org/pkg/net/http/pprof/">net/http/pprof</a>中也提供了trace：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">wget -O trace.out http://localhost:6060/debug/pprof/trace?seconds<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>
</code></pre></div><h3 id="go-test时产生trace">go test时产生trace</h3>
<p><a href="https://golang.org/cmd/go/#hdr-Testing_flags">相关flag</a>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ go test -trace<span style="color:#f92672">=</span>trace.out pkg

-trace trace.out
    Write an execution trace to the specified file before exiting.
</code></pre></div><h2 id="参考资料">参考资料</h2>
<ul>
<li><a href="https://blog.golang.org/2011/06/profiling-go-programs.html">Profiling Go Programs</a></li>
<li><a href="https://www.ardanlabs.com/blog/2019/05/garbage-collection-in-go-part2-gctraces.html">Garbage Collection In Go : Part II - GC Traces</a>。</li>
</ul>
        </p>
    </div>
    

    <div class="page-footer">
        
        <hr class="footer-divider">
        
            <a class="tag" href="https://chanjarster.github.io/tags/go">#go</a>
        
            <a class="tag" href="https://chanjarster.github.io/tags/cheatsheet">#cheatsheet</a>
        
            <a class="tag" href="https://chanjarster.github.io/tags/debug">#debug</a>
        
      
    </div>


        
        </div>
        <footer class="footer-mobile">
	<div class="social-icons">
        

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="chanjarster" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    
    

    

    

    

    

</div>




	<div class="footer-mobile-links">
		<p><a href="https://github.com/kimcc/hugo-theme-noteworthy" target="_blank" rel="noopener">Noteworthy theme</a></p>
		<span class="divider-bar">|</span>
		<p><a href="https://gohugo.io" target="_blank" rel="noopener">Built with Hugo</a></p>
	</div>

	<script src="https://chanjarster.github.io/js/main.min.fa5c2b23e07b5d9bfad267a52b4b24fdb053e6fb7524993383594926a3ac270c.js" integrity="sha256-+lwrI+B7XZv60melK0sk/bBT5vt1JJkzg1lJJqOsJww="></script>
</footer>
    </body>
</html>